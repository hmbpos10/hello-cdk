"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fc = require("fast-check");
const util_1 = require("../../lib/util");
test('deepSet can set deeply', () => {
    const obj = {};
    (0, util_1.deepSet)(obj, ['a', 'b'], 3);
    expect(obj).toEqual({ a: { b: 3 } });
});
test('deepGet can get deeply', () => {
    const obj = { a: { b: 3 } };
    expect((0, util_1.deepGet)(obj, ['a', 'b'])).toBe(3);
});
test('deepGet can return an array', () => {
    const obj = { a: [1, 2, 3] };
    expect((0, util_1.deepGet)(obj, ['a'])).toEqual([1, 2, 3]);
});
test('changing deepClones copy leaves the original intact', () => {
    const original = { a: [{ b: 3 }] };
    const copy = (0, util_1.deepClone)(original);
    copy.a[0].c = 5;
    expect(original).toEqual({ a: [{ b: 3 }] });
});
test('deepMerge merges objects', () => {
    const original = { a: { b: 3 } };
    (0, util_1.deepMerge)(original, { a: { c: 4 } });
    expect(original).toEqual({ a: { b: 3, c: 4 } });
});
test('deepMerge overwrites non-objects', () => {
    const original = { a: [] };
    (0, util_1.deepMerge)(original, { a: { b: 3 } });
    expect(original).toEqual({ a: { b: 3 } });
});
test('deepMerge does not overwrite if rightmost is "undefined"', () => {
    const original = { a: 1 };
    (0, util_1.deepMerge)(original, { a: undefined });
    expect(original).toEqual({ a: 1 });
});
describe('splitBySize', () => {
    test('objects are split at the right place', () => {
        fc.assert(fc.property(fc.object(), fc.integer({ min: 2 }), (data, size) => {
            const [first, second] = (0, util_1.splitBySize)(data, size);
            expect(Buffer.from(JSON.stringify(first)).length).toBeLessThanOrEqual(size);
            expect(merge(first, second)).toEqual(data);
        }));
        function merge(fst, snd) {
            return { ...(fst ?? {}), ...(snd ?? {}) };
        }
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2JqZWN0cy50ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsib2JqZWN0cy50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaUNBQWlDO0FBQ2pDLHlDQUFxRjtBQUVyRixJQUFJLENBQUMsd0JBQXdCLEVBQUUsR0FBRyxFQUFFO0lBQ2xDLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQztJQUNmLElBQUEsY0FBTyxFQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM1QixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztBQUN2QyxDQUFDLENBQUMsQ0FBQztBQUVILElBQUksQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUU7SUFDbEMsTUFBTSxHQUFHLEdBQUcsRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQztJQUM1QixNQUFNLENBQUMsSUFBQSxjQUFPLEVBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDM0MsQ0FBQyxDQUFDLENBQUM7QUFFSCxJQUFJLENBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO0lBQ3ZDLE1BQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDO0lBQzdCLE1BQU0sQ0FBQyxJQUFBLGNBQU8sRUFBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2pELENBQUMsQ0FBQyxDQUFDO0FBRUgs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WUFDL0IsT0FBTyxFQUFFLEdBQUcsQ0FBQyxHQUFHLElBQUksRUFBRSxDQUFDLEVBQUUsR0FBRyxDQUFDLEdBQUcsSUFBSSxFQUFFLENBQUMsRUFBRSxDQUFDO1FBQzVDLENBQUM7SUFDSCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgZmMgZnJvbSAnZmFzdC1jaGVjayc7XG5pbXBvcnQgeyBkZWVwQ2xvbmUsIGRlZXBHZXQsIGRlZXBNZXJnZSwgZGVlcFNldCwgc3BsaXRCeVNpemUgfSBmcm9tICcuLi8uLi9saWIvdXRpbCc7XG5cbnRlc3QoJ2RlZXBTZXQgY2FuIHNldCBkZWVwbHknLCAoKSA9PiB7XG4gIGNvbnN0IG9iaiA9IHt9O1xuICBkZWVwU2V0KG9iaiwgWydhJywgJ2InXSwgMyk7XG4gIGV4cGVjdChvYmopLnRvRXF1YWwoeyBhOiB7IGI6IDMgfSB9KTtcbn0pO1xuXG50ZXN0KCdkZWVwR2V0IGNhbiBnZXQgZGVlcGx5JywgKCkgPT4ge1xuICBjb25zdCBvYmogPSB7IGE6IHsgYjogMyB9IH07XG4gIGV4cGVjdChkZWVwR2V0KG9iaiwgWydhJywgJ2InXSkpLnRvQmUoMyk7XG59KTtcblxudGVzdCgnZGVlcEdldCBjYW4gcmV0dXJuIGFuIGFycmF5JywgKCkgPT4ge1xuICBjb25zdCBvYmogPSB7IGE6IFsxLCAyLCAzXSB9O1xuICBleHBlY3QoZGVlcEdldChvYmosIFsnYSddKSkudG9FcXVhbChbMSwgMiwgM10pO1xufSk7XG5cbnRlc3QoJ2NoYW5naW5nIGRlZXBDbG9uZXMgY29weSBsZWF2ZXMgdGhlIG9yaWdpbmFsIGludGFjdCcsICgpID0+IHtcbiAgY29uc3Qgb3JpZ2luYWwgPSB7IGE6IFt7IGI6IDMgfV0gfTtcbiAgY29uc3QgY29weSA9IGRlZXBDbG9uZShvcmlnaW5hbCk7XG4gIGNvcHkuYVswXS5jID0gNTtcblxuICBleHBlY3Qob3JpZ2luYWwpLnRvRXF1YWwoeyBhOiBbeyBiOiAzIH1dIH0pO1xufSk7XG5cbnRlc3QoJ2RlZXBNZXJnZSBtZXJnZXMgb2JqZWN0cycsICgpID0+IHtcbiAgY29uc3Qgb3JpZ2luYWwgPSB7IGE6IHsgYjogMyB9IH07XG4gIGRlZXBNZXJnZShvcmlnaW5hbCwgeyBhOiB7IGM6IDQgfSB9KTtcblxuICBleHBlY3Qob3JpZ2luYWwpLnRvRXF1YWwoeyBhOiB7IGI6IDMsIGM6IDQgfSB9KTtcbn0pO1xuXG50ZXN0KCdkZWVwTWVyZ2Ugb3ZlcndyaXRlcyBub24tb2JqZWN0cycsICgpID0+IHtcbiAgY29uc3Qgb3JpZ2luYWwgPSB7IGE6IFtdIH07XG4gIGRlZXBNZXJnZShvcmlnaW5hbCwgeyBhOiB7IGI6IDMgfSB9KTtcblxuICBleHBlY3Qob3JpZ2luYWwpLnRvRXF1YWwoeyBhOiB7IGI6IDMgfSB9KTtcbn0pO1xuXG50ZXN0KCdkZWVwTWVyZ2UgZG9lcyBub3Qgb3ZlcndyaXRlIGlmIHJpZ2h0bW9zdCBpcyBcInVuZGVmaW5lZFwiJywgKCkgPT4ge1xuICBjb25zdCBvcmlnaW5hbCA9IHsgYTogMSB9O1xuICBkZWVwTWVyZ2Uob3JpZ2luYWwsIHsgYTogdW5kZWZpbmVkIH0pO1xuXG4gIGV4cGVjdChvcmlnaW5hbCkudG9FcXVhbCh7IGE6IDEgfSk7XG59KTtcblxuZGVzY3JpYmUoJ3NwbGl0QnlTaXplJywgKCkgPT4ge1xuICB0ZXN0KCdvYmplY3RzIGFyZSBzcGxpdCBhdCB0aGUgcmlnaHQgcGxhY2UnLCAoKSA9PiB7XG4gICAgZmMuYXNzZXJ0KFxuICAgICAgZmMucHJvcGVydHkoZmMub2JqZWN0KCksIGZjLmludGVnZXIoeyBtaW46IDIgfSksIChkYXRhLCBzaXplKSA9PiB7XG4gICAgICAgIGNvbnN0IFtmaXJzdCwgc2Vjb25kXSA9IHNwbGl0QnlTaXplKGRhdGEsIHNpemUpO1xuXG4gICAgICAgIGV4cGVjdChCdWZmZXIuZnJvbShKU09OLnN0cmluZ2lmeShmaXJzdCkpLmxlbmd0aCkudG9CZUxlc3NUaGFuT3JFcXVhbChzaXplKTtcbiAgICAgICAgZXhwZWN0KG1lcmdlKGZpcnN0LCBzZWNvbmQpKS50b0VxdWFsKGRhdGEpO1xuICAgICAgfSksXG4gICAgKTtcblxuICAgIGZ1bmN0aW9uIG1lcmdlKGZzdDogYW55LCBzbmQ6IGFueSkge1xuICAgICAgcmV0dXJuIHsgLi4uKGZzdCA/PyB7fSksIC4uLihzbmQgPz8ge30pIH07XG4gICAgfVxuICB9KTtcbn0pOyJdfQ==