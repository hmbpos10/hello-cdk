"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const deploy_1 = require("../lib/deploy");
const sleep = async (duration) => new Promise((resolve) => setTimeout(() => resolve(), duration));
// Not great to have actual sleeps in the tests, but they mostly just exist to give 'p-queue'
// a chance to start new tasks.
const SLOW = 200;
/**
 * Repurposing unused stack attributes to create specific test scenarios
 * - stack.name          = deployment duration
 * - stack.displayName   = error message
 */
describe('DeployStacks', () => {
    const deployedStacks = [];
    const deployStack = async ({ id, displayName, name }) => {
        const errorMessage = displayName;
        const timeout = Number(name) || 0;
        await sleep(timeout);
        if (errorMessage) {
            throw Error(errorMessage);
        }
        deployedStacks.push(id);
    };
    beforeEach(() => {
        deployedStacks.splice(0);
    });
    // Success
    test.each([
        // Concurrency 1
        { scenario: 'No Stacks', concurrency: 1, toDeploy: [], expected: [] },
        { scenario: 'A', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [] }], expected: ['A'] },
        { scenario: 'A, B', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [] }], expected: ['A', 'B'] },
        { scenario: 'A -> B', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [{ id: 'A' }] }], expected: ['A', 'B'] },
        { scenario: '[unsorted] A -> B', concurrency: 1, toDeploy: [{ id: 'B', dependencies: [{ id: 'A' }] }, { id: 'A', dependencies: [] }], expected: ['A', 'B'] },
        { scenario: 'A -> B -> C', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [{ id: 'A' }] }, { id: 'C', dependencies: [{ id: 'B' }] }], expected: ['A', 'B', 'C'] },
        { scenario: 'A -> B, A -> C', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [{ id: 'A' }] }, { id: 'C', dependencies: [{ id: 'A' }] }], expected: ['A', 'B', 'C'] },
        {
            scenario: 'A (slow), B',
            concurrency: 1,
            toDeploy: [
                { id: 'A', dependencies: [], name: SLOW },
                { id: 'B', dependencies: [] },
            ],
            expected: ['A', 'B'],
        },
        {
            scenario: 'A -> B, C -> D',
            concurrency: 1,
            toDeploy: [
                { id: 'A', dependencies: [] },
                { id: 'B', dependencies: [{ id: 'A' }] },
                { id: 'C', dependencies: [] },
                { id: 'D', dependencies: [{ id: 'C' }] },
            ],
            expected: ['A', 'C', 'B', 'D'],
        },
        {
            scenario: 'A (slow) -> B, C -> D',
            concurrency: 1,
            toDeploy: [
                { id: 'A', dependencies: [], name: SLOW },
                { id: 'B', dependencies: [{ id: 'A' }] },
                { id: 'C', dependencies: [] },
                { id: 'D', dependencies: [{ id: 'C' }] },
            ],
            expected: ['A', 'C', 'B', 'D'],
        },
        // Concurrency 2
        { scenario: 'No Stacks', concurrency: 2, toDeploy: [], expected: [] },
        { scenario: 'A', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [] }], expected: ['A'] },
        { scenario: 'A, B', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [] }], expected: ['A', 'B'] },
        { scenario: 'A -> B', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [{ id: 'A' }] }], expected: ['A', 'B'] },
        { scenario: '[unsorted] A -> B', concurrency: 2, toDeploy: [{ id: 'B', dependencies: [{ id: 'A' }] }, { id: 'A', dependencies: [] }], expected: ['A', 'B'] },
        { scenario: 'A -> B -> C', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [{ id: 'A' }] }, { id: 'C', dependencies: [{ id: 'B' }] }], expected: ['A', 'B', 'C'] },
        { scenario: 'A -> B, A -> C', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [{ id: 'A' }] }, { id: 'C', dependencies: [{ id: 'A' }] }], expected: ['A', 'B', 'C'] },
        {
            scenario: 'A, B',
            concurrency: 2,
            toDeploy: [
                { id: 'A', dependencies: [], name: SLOW },
                { id: 'B', dependencies: [] },
            ],
            expected: ['B', 'A'],
        },
        {
            scenario: 'A -> B, C -> D',
            concurrency: 2,
            toDeploy: [
                { id: 'A', dependencies: [] },
                { id: 'B', dependencies: [{ id: 'A' }] },
                { id: 'C', dependencies: [] },
                { id: 'D', dependencies: [{ id: 'C' }] },
            ],
            expected: ['A', 'C', 'B', 'D'],
        },
        {
            scenario: 'A (slow) -> B, C -> D',
            concurrency: 2,
            toDeploy: [
                { id: 'A', dependencies: [], name: SLOW },
                { id: 'B', dependencies: [{ id: 'A' }] },
                { id: 'C', dependencies: [] },
                { id: 'D', dependencies: [{ id: 'C' }] },
            ],
            expected: ['C', 'D', 'A', 'B'],
        },
        {
            scenario: 'A -> B, A not selected',
            concurrency: 1,
            toDeploy: [
                { id: 'B', dependencies: [{ id: 'A' }] },
            ],
            expected: ['B'],
        },
    ])('Success - Concurrency: $concurrency - $scenario', async ({ concurrency, expected, toDeploy }) => {
        await expect((0, deploy_1.deployStacks)(toDeploy, { concurrency, deployStack })).resolves.toBeUndefined();
        expect(deployedStacks).toStrictEqual(expected);
    });
    // Failure
    test.each([
        // Concurrency 1
        { scenario: 'A (error)', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [], displayName: 'A' }], expectedError: 'A', expectedStacks: [] },
        { scenario: 'A (error), B', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [], displayName: 'A' }, { id: 'B', dependencies: [] }], expectedError: 'A', expectedStacks: [] },
        { scenario: 'A, B (error)', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [], displayName: 'B' }], expectedError: 'B', expectedStacks: ['A'] },
        { scenario: 'A (error) -> B', concurrency: 1, toDeploy: [{ id: 'A', dependencies: [], displayName: 'A' }, { id: 'B', dependencies: [{ id: 'A' }] }], expectedError: 'A', expectedStacks: [] },
        { scenario: '[unsorted] A (error) -> B', concurrency: 1, toDeploy: [{ id: 'B', dependencies: [{ id: 'A' }] }, { id: 'A', dependencies: [], displayName: 'A' }], expectedError: 'A', expectedStacks: [] },
        {
            scenario: 'A (error) -> B, C -> D',
            concurrency: 1,
            toDeploy: [
                { id: 'A', dependencies: [], displayName: 'A' },
                { id: 'B', dependencies: [{ id: 'A' }] },
                { id: 'C', dependencies: [] },
                { id: 'D', dependencies: [{ id: 'C' }] },
            ],
            expectedError: 'A',
            expectedStacks: [],
        },
        {
            scenario: 'A -> B, C (error) -> D',
            concurrency: 1,
            toDeploy: [
                { id: 'A', dependencies: [] },
                { id: 'B', dependencies: [{ id: 'A' }] },
                { id: 'C', dependencies: [], displayName: 'C', name: SLOW },
                { id: 'D', dependencies: [{ id: 'C' }] },
            ],
            expectedError: 'C',
            expectedStacks: ['A'],
        },
        // Concurrency 2
        { scenario: 'A (error)', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [], displayName: 'A' }], expectedError: 'A', expectedStacks: [] },
        { scenario: 'A (error), B', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [], displayName: 'A' }, { id: 'B', dependencies: [] }], expectedError: 'A', expectedStacks: ['B'] },
        { scenario: 'A, B (error)', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [] }, { id: 'B', dependencies: [], displayName: 'B' }], expectedError: 'B', expectedStacks: ['A'] },
        { scenario: 'A (error) -> B', concurrency: 2, toDeploy: [{ id: 'A', dependencies: [], displayName: 'A' }, { id: 'B', dependencies: [{ id: 'A' }] }], expectedError: 'A', expectedStacks: [] },
        { scenario: '[unsorted] A (error) -> B', concurrency: 2, toDeploy: [{ id: 'B', dependencies: [{ id: 'A' }] }, { id: 'A', dependencies: [], displayName: 'A' }], expectedError: 'A', expectedStacks: [] },
        {
            scenario: 'A (error) -> B, C -> D',
            concurrency: 2,
            toDeploy: [
                { id: 'A', dependencies: [], displayName: 'A' },
                { id: 'B', dependencies: [{ id: 'A' }] },
                { id: 'C', dependencies: [] },
                { id: 'D', dependencies: [{ id: 'C' }] },
            ],
            expectedError: 'A',
            expectedStacks: ['C'],
        },
        {
            scenario: 'A -> B, C (error) -> D',
            concurrency: 2,
            toDeploy: [
                { id: 'A', dependencies: [] },
                { id: 'B', dependencies: [{ id: 'A' }] },
                { id: 'C', dependencies: [], displayName: 'C', name: SLOW },
                { id: 'D', dependencies: [{ id: 'C' }] },
            ],
            expectedError: 'C',
            expectedStacks: ['A', 'B'],
        },
    ])('Failure - Concurrency: $concurrency - $scenario', async ({ concurrency, expectedError, toDeploy, expectedStacks }) => {
        await expect((0, deploy_1.deployStacks)(toDeploy, { concurrency, deployStack })).rejects.toThrowError(expectedError);
        expect(deployedStacks).toStrictEqual(expectedStacks);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGVwbG95LnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJkZXBsb3kudGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLDBDQUE2QztBQUk3QyxNQUFNLEtBQUssR0FBRyxLQUFLLEVBQUUsUUFBZ0IsRUFBRSxFQUFFLENBQUMsSUFBSSxPQUFPLENBQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO0FBRWhILDZGQUE2RjtBQUM3RiwrQkFBK0I7QUFDL0IsTUFBTSxJQUFJLEdBQUcsR0FBRyxDQUFDO0FBRWpCOzs7O0dBSUc7QUFDSCxRQUFRLENBQUMsY0FBYyxFQUFFLEdBQUcsRUFBRTtJQUM1QixNQUFNLGNBQWMsR0FBYSxFQUFFLENBQUM7SUFDcEMsTUFBTSxXQUFXLEdBQUcsS0FBSyxFQUFFLEVBQUUsRUFBRSxFQUFFLFdBQVcsRUFBRSxJQUFJLEVBQVMsRUFBRSxFQUFFO1FBQzdELE1BQU0sWUFBWSxHQUFHLFdBQVcsQ0FBQztRQUNqQyxNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRWxDLE1BQU0sS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXJCLElBQUksWUFBWSxFQUFFO1lBQ2hCLE1BQU0sS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQzNCO1FBRUQsY0FBYyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUMxQixDQUFDLENBQUM7SUFFRixVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsY0FBYyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMzQixDQUFDLENBQUMsQ0FBQztJQUVILFVBQVU7SUFDVixJQUFJLENBQUMsSUFBSSxDQUFDO1FBQ1IsZ0JBQWdCO1FBQ2hCLEVBQUUsUUFBUSxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRTtRQUNyRSxFQUFFLFFBQVEsRUFBRSxHQUFHLEVBQUUsV0FBVyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDN0YsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFdBQVcsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxFQUFFO1FBQ3BJLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRTtRQUNqSixFQUFFLFFBQVEsRUFBRSxtQkFBbUIsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRTtRQUM1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QUFFLFFBQVEsRUFBRSxFQUFFLEVBQUU7UUFDckUsRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFLFdBQVcsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQzdGLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLFFBQVEsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsRUFBRTtRQUNwSSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLEVBQUU7UUFDakosRUFBRSxRQUFRLEVBQUUsbUJBQW1CLEVBQUUsV0FBVyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLEVBQUU7UUFDNUosRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLFdBQVcsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxFQUFFO1FBQ3JNLEVBQUUsUUFBUSxFQUFFLGdCQUFnQixFQUFFLFdBQVcsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxFQUFFO1FBQ3hNO1lBQ0UsUUFBUSxFQUFFLE1BQU07WUFDaEIsV0FBVyxFQUFFLENBQUM7WUFDZCxRQUFRLEVBQUU7Z0JBQ1IsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRTtnQkFDekMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUU7YUFDOUI7WUFDRCxRQUFRLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1NBQ3JCO1FBQ0Q7WUFDRSxRQUFRLEVBQUUsZ0JBQWdCO1lB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WUFBWSxFQUFFLEVBQUUsRUFBRSxXQUFXLEVBQUUsR0FBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLGFBQWEsRUFBRSxHQUFHLEVBQUUsY0FBYyxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDbkwsRUFBRSxRQUFRLEVBQUUsY0FBYyxFQUFFLFdBQVcsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLEVBQUUsRUFBRSxXQUFXLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxhQUFhLEVBQUUsR0FBRyxFQUFFLGNBQWMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ25MLEVBQUUsUUFBUSxFQUFFLGdCQUFnQixFQUFFLFdBQVcsRUFBRSxDQUFDLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsV0FBVyxFQUFFLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxhQUFhLEVBQUUsR0FBRyxFQUFFLGNBQWMsRUFBRSxFQUFFLEVBQUU7UUFDN0wsRUFBRSxRQUFRLEVBQUUsMkJBQTJCLEVBQUUsV0FBVyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsRUFBRSxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLGFBQWEsRUFBRSxHQUFHLEVBQUUsY0FBYyxFQUFFLEVBQUUsRUFBRTtRQUN4TTtZQUNFLFFBQVEsRUFBRSx3QkFBd0I7WUFDbEMsV0FBVyxFQUFFLENBQUM7WUFDZCxRQUFRLEVBQUU7Z0JBQ1IsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxFQUFFLEVBQUUsV0FBVyxFQUFFLEdBQUcsRUFBRTtnQkFDL0MsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUU7Z0JBQ3hDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsRUFBRSxFQUFFO2dCQUM3QixFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRTthQUN6QztZQUNELGFBQWEsRUFBRSxHQUFHO1lBQ2xCLGNBQWMsRUFBRSxDQUFDLEdBQUcsQ0FBQztTQUN0QjtRQUNEO1lBQ0UsUUFBUSxFQUFFLHdCQUF3QjtZQUNsQyxXQUFXLEVBQUUsQ0FBQztZQUNkLFFBQVEsRUFBRTtnQkFDUixFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsWUFBWSxFQUFFLEVBQUUsRUFBRTtnQkFDN0IsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUU7Z0JBQ3hDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxZQUFZLEVBQUUsRUFBRSxFQUFFLFdBQVcsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRTtnQkFDM0QsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLFlBQVksRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUU7YUFDekM7WUFDRCxhQUFhLEVBQUUsR0FBRztZQUNsQixjQUFjLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1NBQzNCO0tBQ0YsQ0FBQyxDQUFDLGlEQUFpRCxFQUFFLEtBQUssRUFBRSxFQUFFLFdBQVcsRUFBRSxhQUFhLEVBQUUsUUFBUSxFQUFFLGNBQWMsRUFBRSxFQUFFLEVBQUU7UUFDdkgsTUFBTSxNQUFNLENBQUMsSUFBQSxxQkFBWSxFQUFDLFFBQThCLEVBQUUsRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDLENBQUM7UUFFN0gsTUFBTSxDQUFDLGNBQWMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUN2RCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgY3hhcGkgZnJvbSAnQGF3cy1jZGsvY3gtYXBpJztcbmltcG9ydCB7IGRlcGxveVN0YWNrcyB9IGZyb20gJy4uL2xpYi9kZXBsb3knO1xuXG50eXBlIFN0YWNrID0gY3hhcGkuQ2xvdWRGb3JtYXRpb25TdGFja0FydGlmYWN0O1xuXG5jb25zdCBzbGVlcCA9IGFzeW5jIChkdXJhdGlvbjogbnVtYmVyKSA9PiBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSkgPT4gc2V0VGltZW91dCgoKSA9PiByZXNvbHZlKCksIGR1cmF0aW9uKSk7XG5cbi8vIE5vdCBncmVhdCB0byBoYXZlIGFjdHVhbCBzbGVlcHMgaW4gdGhlIHRlc3RzLCBidXQgdGhleSBtb3N0bHkganVzdCBleGlzdCB0byBnaXZlICdwLXF1ZXVlJ1xuLy8gYSBjaGFuY2UgdG8gc3RhcnQgbmV3IHRhc2tzLlxuY29uc3QgU0xPVyA9IDIwMDtcblxuLyoqXG4gKiBSZXB1cnBvc2luZyB1bnVzZWQgc3RhY2sgYXR0cmlidXRlcyB0byBjcmVhdGUgc3BlY2lmaWMgdGVzdCBzY2VuYXJpb3NcbiAqIC0gc3RhY2submFtZSAgICAgICAgICA9IGRlcGxveW1lbnQgZHVyYXRpb25cbiAqIC0gc3RhY2suZGlzcGxheU5hbWUgICA9IGVycm9yIG1lc3NhZ2VcbiAqL1xuZGVzY3JpYmUoJ0RlcGxveVN0YWNrcycsICgpID0+IHtcbiAgY29uc3QgZGVwbG95ZWRTdGFja3M6IHN0cmluZ1tdID0gW107XG4gIGNvbnN0IGRlcGxveVN0YWNrID0gYXN5bmMgKHsgaWQsIGRpc3BsYXlOYW1lLCBuYW1lIH06IFN0YWNrKSA9PiB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZGlzcGxheU5hbWU7XG4gICAgY29uc3QgdGltZW91dCA9IE51bWJlcihuYW1lKSB8fCAwO1xuXG4gICAgYXdhaXQgc2xlZXAodGltZW91dCk7XG5cbiAgICBpZiAoZXJyb3JNZXNzYWdlKSB7XG4gICAgICB0aHJvdyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICAgIH1cblxuICAgIGRlcGxveWVkU3RhY2tzLnB1c2goaWQpO1xuICB9O1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGRlcGxveWVkU3RhY2tzLnNwbGljZSgwKTtcbiAgfSk7XG5cbiAgLy8gU3VjY2Vzc1xuICB0ZXN0LmVhY2goW1xuICAgIC8vIENvbmN1cnJlbmN5IDFcbiAgICB7IHNjZW5hcmlvOiAnTm8gU3RhY2tzJywgY29uY3VycmVuY3k6IDEsIHRvRGVwbG95OiBbXSwgZXhwZWN0ZWQ6IFtdIH0sXG4gICAgeyBzY2VuYXJpbzogJ0EnLCBjb25jdXJyZW5jeTogMSwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10gfV0sIGV4cGVjdGVkOiBbJ0EnXSB9LFxuICAgIHsgc2NlbmFyaW86ICdBLCBCJywgY29uY3VycmVuY3k6IDEsIHRvRGVwbG95OiBbeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdIH0sIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbXSB9XSwgZXhwZWN0ZWQ6IFsnQScsICdCJ10gfSxcbiAgICB7IHNjZW5hcmlvOiAnQSAtPiBCJywgY29uY3VycmVuY3k6IDEsIHRvRGVwbG95OiBbeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdIH0sIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH1dLCBleHBlY3RlZDogWydBJywgJ0InXSB9LFxuICAgIHsgc2NlbmFyaW86ICdbdW5zb3J0ZWRdIEEgLT4gQicsIGNvbmN1cnJlbmN5OiAxLCB0b0RlcGxveTogW3sgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH0sIHsgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSB9XSwgZXhwZWN0ZWQ6IFsnQScsICdCJ10gfSxcbiAgICB7IHNjZW5hcmlvOiAnQSAtPiBCIC0+IEMnLCBjb25jdXJyZW5jeTogMSwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10gfSwgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfSwgeyBpZDogJ0MnLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQicgfV0gfV0sIGV4cGVjdGVkOiBbJ0EnLCAnQicsICdDJ10gfSxcbiAgICB7IHNjZW5hcmlvOiAnQSAtPiBCLCBBIC0+IEMnLCBjb25jdXJyZW5jeTogMSwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10gfSwgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfSwgeyBpZDogJ0MnLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfV0sIGV4cGVjdGVkOiBbJ0EnLCAnQicsICdDJ10gfSxcbiAgICB7XG4gICAgICBzY2VuYXJpbzogJ0EgKHNsb3cpLCBCJyxcbiAgICAgIGNvbmN1cnJlbmN5OiAxLFxuICAgICAgdG9EZXBsb3k6IFtcbiAgICAgICAgeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdLCBuYW1lOiBTTE9XIH0sXG4gICAgICAgIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbXSB9LFxuICAgICAgXSxcbiAgICAgIGV4cGVjdGVkOiBbJ0EnLCAnQiddLFxuICAgIH0sXG4gICAge1xuICAgICAgc2NlbmFyaW86ICdBIC0+IEIsIEMgLT4gRCcsXG4gICAgICBjb25jdXJyZW5jeTogMSxcbiAgICAgIHRvRGVwbG95OiBbXG4gICAgICAgIHsgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSB9LFxuICAgICAgICB7IGlkOiAnQicsIGRlcGVuZGVuY2llczogW3sgaWQ6ICdBJyB9XSB9LFxuICAgICAgICB7IGlkOiAnQycsIGRlcGVuZGVuY2llczogW10gfSxcbiAgICAgICAgeyBpZDogJ0QnLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQycgfV0gfSxcbiAgICAgIF0sXG4gICAgICBleHBlY3RlZDogWydBJywgJ0MnLCAnQicsICdEJ10sXG4gICAgfSxcbiAgICB7XG4gICAgICBzY2VuYXJpbzogJ0EgKHNsb3cpIC0+IEIsIEMgLT4gRCcsXG4gICAgICBjb25jdXJyZW5jeTogMSxcbiAgICAgIHRvRGVwbG95OiBbXG4gICAgICAgIHsgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSwgbmFtZTogU0xPVyB9LFxuICAgICAgICB7IGlkOiAnQicsIGRlcGVuZGVuY2llczogW3sgaWQ6ICdBJyB9XSB9LFxuICAgICAgICB7IGlkOiAnQycsIGRlcGVuZGVuY2llczogW10gfSxcbiAgICAgICAgeyBpZDogJ0QnLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQycgfV0gfSxcbiAgICAgIF0sXG4gICAgICBleHBlY3RlZDogWydBJywgJ0MnLCAnQicsICdEJ10sXG4gICAgfSxcblxuICAgIC8vIENvbmN1cnJlbmN5IDJcbiAgICB7IHNjZW5hcmlvOiAnTm8gU3RhY2tzJywgY29uY3VycmVuY3k6IDIsIHRvRGVwbG95OiBbXSwgZXhwZWN0ZWQ6IFtdIH0sXG4gICAgeyBzY2VuYXJpbzogJ0EnLCBjb25jdXJyZW5jeTogMiwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10gfV0sIGV4cGVjdGVkOiBbJ0EnXSB9LFxuICAgIHsgc2NlbmFyaW86ICdBLCBCJywgY29uY3VycmVuY3k6IDIsIHRvRGVwbG95OiBbeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdIH0sIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbXSB9XSwgZXhwZWN0ZWQ6IFsnQScsICdCJ10gfSxcbiAgICB7IHNjZW5hcmlvOiAnQSAtPiBCJywgY29uY3VycmVuY3k6IDIsIHRvRGVwbG95OiBbeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdIH0sIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH1dLCBleHBlY3RlZDogWydBJywgJ0InXSB9LFxuICAgIHsgc2NlbmFyaW86ICdbdW5zb3J0ZWRdIEEgLT4gQicsIGNvbmN1cnJlbmN5OiAyLCB0b0RlcGxveTogW3sgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH0sIHsgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSB9XSwgZXhwZWN0ZWQ6IFsnQScsICdCJ10gfSxcbiAgICB7IHNjZW5hcmlvOiAnQSAtPiBCIC0+IEMnLCBjb25jdXJyZW5jeTogMiwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10gfSwgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfSwgeyBpZDogJ0MnLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQicgfV0gfV0sIGV4cGVjdGVkOiBbJ0EnLCAnQicsICdDJ10gfSxcbiAgICB7IHNjZW5hcmlvOiAnQSAtPiBCLCBBIC0+IEMnLCBjb25jdXJyZW5jeTogMiwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10gfSwgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfSwgeyBpZDogJ0MnLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfV0sIGV4cGVjdGVkOiBbJ0EnLCAnQicsICdDJ10gfSxcbiAgICB7XG4gICAgICBzY2VuYXJpbzogJ0EsIEInLFxuICAgICAgY29uY3VycmVuY3k6IDIsXG4gICAgICB0b0RlcGxveTogW1xuICAgICAgICB7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10sIG5hbWU6IFNMT1cgfSxcbiAgICAgICAgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFtdIH0sXG4gICAgICBdLFxuICAgICAgZXhwZWN0ZWQ6IFsnQicsICdBJ10sXG4gICAgfSxcbiAgICB7XG4gICAgICBzY2VuYXJpbzogJ0EgLT4gQiwgQyAtPiBEJyxcbiAgICAgIGNvbmN1cnJlbmN5OiAyLFxuICAgICAgdG9EZXBsb3k6IFtcbiAgICAgICAgeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdIH0sXG4gICAgICAgIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH0sXG4gICAgICAgIHsgaWQ6ICdDJywgZGVwZW5kZW5jaWVzOiBbXSB9LFxuICAgICAgICB7IGlkOiAnRCcsIGRlcGVuZGVuY2llczogW3sgaWQ6ICdDJyB9XSB9LFxuICAgICAgXSxcbiAgICAgIGV4cGVjdGVkOiBbJ0EnLCAnQycsICdCJywgJ0QnXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIHNjZW5hcmlvOiAnQSAoc2xvdykgLT4gQiwgQyAtPiBEJyxcbiAgICAgIGNvbmN1cnJlbmN5OiAyLFxuICAgICAgdG9EZXBsb3k6IFtcbiAgICAgICAgeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdLCBuYW1lOiBTTE9XIH0sXG4gICAgICAgIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH0sXG4gICAgICAgIHsgaWQ6ICdDJywgZGVwZW5kZW5jaWVzOiBbXSB9LFxuICAgICAgICB7IGlkOiAnRCcsIGRlcGVuZGVuY2llczogW3sgaWQ6ICdDJyB9XSB9LFxuICAgICAgXSxcbiAgICAgIGV4cGVjdGVkOiBbJ0MnLCAnRCcsICdBJywgJ0InXSxcbiAgICB9LFxuICAgIHtcbiAgICAgIHNjZW5hcmlvOiAnQSAtPiBCLCBBIG5vdCBzZWxlY3RlZCcsXG4gICAgICBjb25jdXJyZW5jeTogMSxcbiAgICAgIHRvRGVwbG95OiBbXG4gICAgICAgIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH0sXG4gICAgICBdLFxuICAgICAgZXhwZWN0ZWQ6IFsnQiddLFxuICAgIH0sXG4gIF0pKCdTdWNjZXNzIC0gQ29uY3VycmVuY3k6ICRjb25jdXJyZW5jeSAtICRzY2VuYXJpbycsIGFzeW5jICh7IGNvbmN1cnJlbmN5LCBleHBlY3RlZCwgdG9EZXBsb3kgfSkgPT4ge1xuICAgIGF3YWl0IGV4cGVjdChkZXBsb3lTdGFja3ModG9EZXBsb3kgYXMgdW5rbm93biBhcyBTdGFja1tdLCB7IGNvbmN1cnJlbmN5LCBkZXBsb3lTdGFjayB9KSkucmVzb2x2ZXMudG9CZVVuZGVmaW5lZCgpO1xuXG4gICAgZXhwZWN0KGRlcGxveWVkU3RhY2tzKS50b1N0cmljdEVxdWFsKGV4cGVjdGVkKTtcbiAgfSk7XG5cbiAgLy8gRmFpbHVyZVxuICB0ZXN0LmVhY2goW1xuICAgIC8vIENvbmN1cnJlbmN5IDFcbiAgICB7IHNjZW5hcmlvOiAnQSAoZXJyb3IpJywgY29uY3VycmVuY3k6IDEsIHRvRGVwbG95OiBbeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdLCBkaXNwbGF5TmFtZTogJ0EnIH1dLCBleHBlY3RlZEVycm9yOiAnQScsIGV4cGVjdGVkU3RhY2tzOiBbXSB9LFxuICAgIHsgc2NlbmFyaW86ICdBIChlcnJvciksIEInLCBjb25jdXJyZW5jeTogMSwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10sIGRpc3BsYXlOYW1lOiAnQScgfSwgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFtdIH1dLCBleHBlY3RlZEVycm9yOiAnQScsIGV4cGVjdGVkU3RhY2tzOiBbXSB9LFxuICAgIHsgc2NlbmFyaW86ICdBLCBCIChlcnJvciknLCBjb25jdXJyZW5jeTogMSwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10gfSwgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFtdLCBkaXNwbGF5TmFtZTogJ0InIH1dLCBleHBlY3RlZEVycm9yOiAnQicsIGV4cGVjdGVkU3RhY2tzOiBbJ0EnXSB9LFxuICAgIHsgc2NlbmFyaW86ICdBIChlcnJvcikgLT4gQicsIGNvbmN1cnJlbmN5OiAxLCB0b0RlcGxveTogW3sgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSwgZGlzcGxheU5hbWU6ICdBJyB9LCB7IGlkOiAnQicsIGRlcGVuZGVuY2llczogW3sgaWQ6ICdBJyB9XSB9XSwgZXhwZWN0ZWRFcnJvcjogJ0EnLCBleHBlY3RlZFN0YWNrczogW10gfSxcbiAgICB7IHNjZW5hcmlvOiAnW3Vuc29ydGVkXSBBIChlcnJvcikgLT4gQicsIGNvbmN1cnJlbmN5OiAxLCB0b0RlcGxveTogW3sgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH0sIHsgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSwgZGlzcGxheU5hbWU6ICdBJyB9XSwgZXhwZWN0ZWRFcnJvcjogJ0EnLCBleHBlY3RlZFN0YWNrczogW10gfSxcbiAgICB7XG4gICAgICBzY2VuYXJpbzogJ0EgKGVycm9yKSAtPiBCLCBDIC0+IEQnLFxuICAgICAgY29uY3VycmVuY3k6IDEsXG4gICAgICB0b0RlcGxveTogW1xuICAgICAgICB7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10sIGRpc3BsYXlOYW1lOiAnQScgfSxcbiAgICAgICAgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfSxcbiAgICAgICAgeyBpZDogJ0MnLCBkZXBlbmRlbmNpZXM6IFtdIH0sXG4gICAgICAgIHsgaWQ6ICdEJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0MnIH1dIH0sXG4gICAgICBdLFxuICAgICAgZXhwZWN0ZWRFcnJvcjogJ0EnLFxuICAgICAgZXhwZWN0ZWRTdGFja3M6IFtdLFxuICAgIH0sXG4gICAge1xuICAgICAgc2NlbmFyaW86ICdBIC0+IEIsIEMgKGVycm9yKSAtPiBEJyxcbiAgICAgIGNvbmN1cnJlbmN5OiAxLFxuICAgICAgdG9EZXBsb3k6IFtcbiAgICAgICAgeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdIH0sXG4gICAgICAgIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH0sXG4gICAgICAgIHsgaWQ6ICdDJywgZGVwZW5kZW5jaWVzOiBbXSwgZGlzcGxheU5hbWU6ICdDJywgbmFtZTogU0xPVyB9LFxuICAgICAgICB7IGlkOiAnRCcsIGRlcGVuZGVuY2llczogW3sgaWQ6ICdDJyB9XSB9LFxuICAgICAgXSxcbiAgICAgIGV4cGVjdGVkRXJyb3I6ICdDJyxcbiAgICAgIGV4cGVjdGVkU3RhY2tzOiBbJ0EnXSxcbiAgICB9LFxuXG4gICAgLy8gQ29uY3VycmVuY3kgMlxuICAgIHsgc2NlbmFyaW86ICdBIChlcnJvciknLCBjb25jdXJyZW5jeTogMiwgdG9EZXBsb3k6IFt7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10sIGRpc3BsYXlOYW1lOiAnQScgfV0sIGV4cGVjdGVkRXJyb3I6ICdBJywgZXhwZWN0ZWRTdGFja3M6IFtdIH0sXG4gICAgeyBzY2VuYXJpbzogJ0EgKGVycm9yKSwgQicsIGNvbmN1cnJlbmN5OiAyLCB0b0RlcGxveTogW3sgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSwgZGlzcGxheU5hbWU6ICdBJyB9LCB7IGlkOiAnQicsIGRlcGVuZGVuY2llczogW10gfV0sIGV4cGVjdGVkRXJyb3I6ICdBJywgZXhwZWN0ZWRTdGFja3M6IFsnQiddIH0sXG4gICAgeyBzY2VuYXJpbzogJ0EsIEIgKGVycm9yKScsIGNvbmN1cnJlbmN5OiAyLCB0b0RlcGxveTogW3sgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSB9LCB7IGlkOiAnQicsIGRlcGVuZGVuY2llczogW10sIGRpc3BsYXlOYW1lOiAnQicgfV0sIGV4cGVjdGVkRXJyb3I6ICdCJywgZXhwZWN0ZWRTdGFja3M6IFsnQSddIH0sXG4gICAgeyBzY2VuYXJpbzogJ0EgKGVycm9yKSAtPiBCJywgY29uY3VycmVuY3k6IDIsIHRvRGVwbG95OiBbeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdLCBkaXNwbGF5TmFtZTogJ0EnIH0sIHsgaWQ6ICdCJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0EnIH1dIH1dLCBleHBlY3RlZEVycm9yOiAnQScsIGV4cGVjdGVkU3RhY2tzOiBbXSB9LFxuICAgIHsgc2NlbmFyaW86ICdbdW5zb3J0ZWRdIEEgKGVycm9yKSAtPiBCJywgY29uY3VycmVuY3k6IDIsIHRvRGVwbG95OiBbeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfSwgeyBpZDogJ0EnLCBkZXBlbmRlbmNpZXM6IFtdLCBkaXNwbGF5TmFtZTogJ0EnIH1dLCBleHBlY3RlZEVycm9yOiAnQScsIGV4cGVjdGVkU3RhY2tzOiBbXSB9LFxuICAgIHtcbiAgICAgIHNjZW5hcmlvOiAnQSAoZXJyb3IpIC0+IEIsIEMgLT4gRCcsXG4gICAgICBjb25jdXJyZW5jeTogMixcbiAgICAgIHRvRGVwbG95OiBbXG4gICAgICAgIHsgaWQ6ICdBJywgZGVwZW5kZW5jaWVzOiBbXSwgZGlzcGxheU5hbWU6ICdBJyB9LFxuICAgICAgICB7IGlkOiAnQicsIGRlcGVuZGVuY2llczogW3sgaWQ6ICdBJyB9XSB9LFxuICAgICAgICB7IGlkOiAnQycsIGRlcGVuZGVuY2llczogW10gfSxcbiAgICAgICAgeyBpZDogJ0QnLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQycgfV0gfSxcbiAgICAgIF0sXG4gICAgICBleHBlY3RlZEVycm9yOiAnQScsXG4gICAgICBleHBlY3RlZFN0YWNrczogWydDJ10sXG4gICAgfSxcbiAgICB7XG4gICAgICBzY2VuYXJpbzogJ0EgLT4gQiwgQyAoZXJyb3IpIC0+IEQnLFxuICAgICAgY29uY3VycmVuY3k6IDIsXG4gICAgICB0b0RlcGxveTogW1xuICAgICAgICB7IGlkOiAnQScsIGRlcGVuZGVuY2llczogW10gfSxcbiAgICAgICAgeyBpZDogJ0InLCBkZXBlbmRlbmNpZXM6IFt7IGlkOiAnQScgfV0gfSxcbiAgICAgICAgeyBpZDogJ0MnLCBkZXBlbmRlbmNpZXM6IFtdLCBkaXNwbGF5TmFtZTogJ0MnLCBuYW1lOiBTTE9XIH0sXG4gICAgICAgIHsgaWQ6ICdEJywgZGVwZW5kZW5jaWVzOiBbeyBpZDogJ0MnIH1dIH0sXG4gICAgICBdLFxuICAgICAgZXhwZWN0ZWRFcnJvcjogJ0MnLFxuICAgICAgZXhwZWN0ZWRTdGFja3M6IFsnQScsICdCJ10sXG4gICAgfSxcbiAgXSkoJ0ZhaWx1cmUgLSBDb25jdXJyZW5jeTogJGNvbmN1cnJlbmN5IC0gJHNjZW5hcmlvJywgYXN5bmMgKHsgY29uY3VycmVuY3ksIGV4cGVjdGVkRXJyb3IsIHRvRGVwbG95LCBleHBlY3RlZFN0YWNrcyB9KSA9PiB7XG4gICAgYXdhaXQgZXhwZWN0KGRlcGxveVN0YWNrcyh0b0RlcGxveSBhcyB1bmtub3duIGFzIFN0YWNrW10sIHsgY29uY3VycmVuY3ksIGRlcGxveVN0YWNrIH0pKS5yZWplY3RzLnRvVGhyb3dFcnJvcihleHBlY3RlZEVycm9yKTtcblxuICAgIGV4cGVjdChkZXBsb3llZFN0YWNrcykudG9TdHJpY3RFcXVhbChleHBlY3RlZFN0YWNrcyk7XG4gIH0pO1xufSk7Il19